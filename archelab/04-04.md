# ArchElab 04-04
## Esempio di funzione ricorsiva
Implemtazione della funzione fact: $\mathbb{N}$ ---> $\mathbb{N}$ t.c. fact(n) = n! $\forall$n $\in$ $\mathbb{N}$
in assembly RISC-V.

```a
fact:
#prologo della funzione
	addi sp, sp, -12
	sw a0, 8(sp)	#salva n sullo stack
	sw ra, 4,(sp)	#salva l'indirizzo di ritorno
	sw fp, 0(sp)	#salva il frame pointer precedente
	addi fp, sp, 8	#aggiorna il frame pointer
	
#passo base
	bne a0, zero, passo_induttivo
	addi a0, zero, 1	#perché fact(0) = 0! = 1
	beq zero, zero, fine
	
#passo induttivo
passo_induttivo:
	addi a0, a0, -1
	jal fact
	lw t0, 0(fp)	#carica il valore di n
	mul a0, a0, t0	#fact(n) = n! = n*(n-1)
	
#epilogo della funzione
	lw fp, 0(sp)
	lw ra, 4(sp)
	addi sp, sp, 12
	jr ra
```

## Operandi immediati ampi (32 bit)
Per caricare in un registro una costante di 32 bit si usano due istruzioni

* **lui**: (load upper immediate), che carica i 20 bit più significativi 
* **ori**: per settare i restanti 12 bit

Ad esempio, se voglio caricare la costante **0x8a42f11b** nel registro t1, userò:

```
lui t0, 0x8a42f
ori t0, t0, 0x11b
```